import{_ as M,M as k,o as n,b as i,d as t,i as c,L as r,F as y,h as V,t as p,N as U,e as w,H as f,r as g,j as v}from"./index-8XiAlZLe.js";import{A as _}from"./swal-6HxkfyAW.js";import{P as D}from"./PaginationComponent-LYKHxE5n.js";import"./sweetalert2.all-15ItP-RY.js";const T={props:["tempProduct","updateProduct","isNew"],data(){return{modalProduct:null,editProduct:{}}},methods:{openModal(){this.modalProduct.show()},closeModal(){this.modalProduct.hide()}},mounted(){this.modalProduct=new k(this.$refs.productModal)},watch:{tempProduct(){this.editProduct=this.tempProduct}}},A={id:"productModal",ref:"productModal",class:"modal fade",tabindex:"-1"},N={class:"modal-dialog modal-xl"},I={class:"modal-content border-0"},E={class:"modal-header bg-dark text-white"},L={id:"productModalLabel",class:"modal-title"},R={key:0},S={key:1},$=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),B={class:"modal-body"},H={class:"row"},j={class:"col-sm-4"},F={class:"mb-3"},J=t("label",{for:"imageUrl",class:"form-label"},"主要圖片",-1),O=["src"],z=t("h3",{class:"mb-3"},"多圖新增",-1),K={key:0},W={class:"mb-3"},Y=["for"],q=["id","onUpdate:modelValue"],G=["src"],Q={key:0},X={key:1},Z={key:1},tt={class:"col-sm-8"},ot={class:"mb-3"},et=t("label",{for:"title",class:"form-label"},"餐點名稱",-1),st={class:"row"},lt={class:"mb-3 col-md-6"},dt=t("label",{for:"category",class:"form-label"},"分類",-1),nt={class:"mb-3 col-md-6"},it=t("label",{for:"num",class:"form-label"},"數量",-1),ct={class:"row"},rt={class:"mb-3 col-md-6"},at=t("label",{for:"origin_price",class:"form-label"},"原價",-1),ut={class:"mb-3 col-md-6"},mt=t("label",{for:"price",class:"form-label"},"售價",-1),pt={class:"row"},_t={class:"mb-3 col-2"},ht=t("label",{for:"unit",class:"form-label"},"單位",-1),bt={class:"mb-3 col-2"},Pt=t("label",{for:"content",class:"form-label"},"內容",-1),ft=t("hr",null,null,-1),gt={class:"mb-3"},vt=t("label",{for:"info",class:"form-label"},"特色",-1),yt={class:"mb-3"},Mt=t("label",{for:"description",class:"form-label"},"餐點描述",-1),xt={class:"mb-3"},Ut=t("label",{for:"allergy",class:"form-label"},"過敏資訊",-1),wt={class:"mb-3"},kt={class:"form-check"},Vt=t("label",{class:"form-check-label",for:"is_enabled"},"是否啟用",-1),Ct={class:"mb-3"},Dt={class:"form-check"},Tt=t("label",{class:"form-check-label",for:"is_enabled"},"是否熱銷",-1),At={class:"modal-footer"},Nt=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function It(d,o,l,x,e,u){return n(),i("div",A,[t("div",N,[t("div",I,[t("div",E,[t("h5",L,[l.isNew?(n(),i("span",R,"新增餐點")):(n(),i("span",S,"編輯餐點"))]),$]),t("div",B,[t("div",H,[t("div",j,[t("div",F,[J,c(t("input",{id:"imageUrl","onUpdate:modelValue":o[0]||(o[0]=s=>e.editProduct.imageUrl=s),type:"text",class:"form-control mb-2",placeholder:"請輸入圖片連結"},null,512),[[r,e.editProduct.imageUrl]]),t("img",{class:"img-fluid",src:e.editProduct.imageUrl},null,8,O)]),z,Array.isArray(e.editProduct.imagesUrl)?(n(),i("div",K,[(n(!0),i(y,null,V(e.editProduct.imagesUrl,(s,m)=>(n(),i("div",{class:"mb-1",key:m},[t("div",W,[t("label",{for:s+m,class:"form-label"},"圖片網址",8,Y),c(t("input",{id:s+m,"onUpdate:modelValue":P=>e.editProduct.imagesUrl[m]=P,type:"text",class:"form-control",placeholder:"請輸入圖片連結"},null,8,q),[[r,e.editProduct.imagesUrl[m]]])]),t("img",{class:"img-fluid",src:s},null,8,G)]))),128)),!e.editProduct.imagesUrl.length||e.editProduct.imagesUrl[e.editProduct.imagesUrl.length-1]?(n(),i("div",Q,[t("button",{class:"btn btn-outline-secondary btn-sm d-block w-100",onClick:o[1]||(o[1]=s=>e.editProduct.imagesUrl.push(""))}," 新增圖片 ")])):(n(),i("div",X,[t("button",{class:"btn btn-outline-danger btn-sm d-block w-100",onClick:o[2]||(o[2]=s=>e.editProduct.imagesUrl.pop())}," 刪除圖片 ")]))])):(n(),i("div",Z,[t("button",{class:"btn btn-outline-secondary btn-sm d-block w-100",onClick:o[3]||(o[3]=(...s)=>d.createImages&&d.createImages(...s))}," 新增圖片 ")]))]),t("div",tt,[t("pre",null,"                "+p(e.editProduct)+`
              `,1),t("div",ot,[et,c(t("input",{id:"title","onUpdate:modelValue":o[4]||(o[4]=s=>e.editProduct.title=s),type:"text",class:"form-control",placeholder:"請輸入餐點名稱"},null,512),[[r,e.editProduct.title]])]),t("div",st,[t("div",lt,[dt,c(t("input",{id:"category","onUpdate:modelValue":o[5]||(o[5]=s=>e.editProduct.category=s),type:"text",class:"form-control",placeholder:"請輸入分類"},null,512),[[r,e.editProduct.category]])]),t("div",nt,[it,c(t("input",{id:"num","onUpdate:modelValue":o[6]||(o[6]=s=>e.editProduct.num=s),type:"number",min:"0",class:"form-control",placeholder:"請輸入數量"},null,512),[[r,e.editProduct.num,void 0,{number:!0}]])])]),t("div",ct,[t("div",rt,[at,c(t("input",{id:"origin_price","onUpdate:modelValue":o[7]||(o[7]=s=>e.editProduct.origin_price=s),type:"number",min:"0",class:"form-control",placeholder:"請輸入原價"},null,512),[[r,e.editProduct.origin_price,void 0,{number:!0}]])]),t("div",ut,[mt,c(t("input",{id:"price","onUpdate:modelValue":o[8]||(o[8]=s=>e.editProduct.price=s),type:"number",min:"0",class:"form-control",placeholder:"請輸入售價"},null,512),[[r,e.editProduct.price,void 0,{number:!0}]])])]),t("div",pt,[t("div",_t,[ht,c(t("input",{id:"unit","onUpdate:modelValue":o[9]||(o[9]=s=>e.editProduct.unit=s),type:"text",class:"form-control"},null,512),[[r,e.editProduct.unit]])]),t("div",bt,[Pt,c(t("input",{id:"content","onUpdate:modelValue":o[10]||(o[10]=s=>e.editProduct.content=s),type:"text",class:"form-control"},null,512),[[r,e.editProduct.content]])])]),ft,t("div",gt,[vt,c(t("input",{id:"info","onUpdate:modelValue":o[11]||(o[11]=s=>e.editProduct.info=s),type:"text",class:"form-control",placeholder:"請輸入特色"},null,512),[[r,e.editProduct.info]])]),t("div",yt,[Mt,c(t("textarea",{id:"description","onUpdate:modelValue":o[12]||(o[12]=s=>e.editProduct.description=s),type:"text",class:"form-control",placeholder:"請輸入餐點描述"},`\r
                `,512),[[r,e.editProduct.description]])]),t("div",xt,[Ut,c(t("input",{id:"allergy","onUpdate:modelValue":o[13]||(o[13]=s=>e.editProduct.allergy=s),type:"text",class:"form-control",placeholder:"請輸入過敏資訊"},null,512),[[r,e.editProduct.allergy]])]),t("div",wt,[t("div",kt,[c(t("input",{id:"is_enabled","onUpdate:modelValue":o[14]||(o[14]=s=>e.editProduct.is_enabled=s),class:"form-check-input",type:"checkbox","true-value":1,"false-value":0},null,512),[[U,e.editProduct.is_enabled]]),Vt])]),t("div",Ct,[t("div",Dt,[c(t("input",{id:"is_enabled","onUpdate:modelValue":o[15]||(o[15]=s=>e.editProduct.is_hot=s),class:"form-check-input",type:"checkbox","true-value":1,"false-value":0},null,512),[[U,e.editProduct.is_hot]]),Tt])])])])]),t("div",At,[Nt,t("button",{type:"button",class:"btn btn-secondary",onClick:o[16]||(o[16]=(...s)=>l.updateProduct&&l.updateProduct(...s))},"確認")])])])],512)}const Et=M(T,[["render",It]]),Lt={props:["tempProduct","delProduct"],data(){return{delModalProduct:null}},methods:{openDelModal(){this.delModalProduct.show()},closeDelModal(){this.delModalProduct.hide()}},mounted(){this.delModalProduct=new k(this.$refs.delProductModal)}},Rt={id:"delProductModal",ref:"delProductModal",class:"modal fade",tabindex:"-1","aria-labelledby":"delProductModalLabel","aria-hidden":"true"},St={class:"modal-dialog"},$t={class:"modal-content border-0"},Bt=t("div",{class:"modal-header bg-danger text-white"},[t("h5",{id:"delProductModalLabel",class:"modal-title"},[t("span",null,"刪除產品")]),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Ht={class:"modal-body"},jt={class:"text-danger"},Ft={class:"modal-footer"},Jt=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function Ot(d,o,l,x,e,u){return n(),i("div",Rt,[t("div",St,[t("div",$t,[Bt,t("div",Ht,[w(" 是否刪除 "),t("strong",jt,p(l.tempProduct.title),1),w(" 商品(刪除後將無法恢復)。 ")]),t("div",Ft,[Jt,t("button",{type:"button",class:"btn btn-danger",onClick:o[0]||(o[0]=(...s)=>l.delProduct&&l.delProduct(...s))},"確認刪除")])])])],512)}const zt=M(Lt,[["render",Ot]]);var Kt={VITE_API_URL:"https://ec-course-api.hexschool.io/v2",VITE_API_PATH:"js23",VITE_MAP_KEY:"AIzaSyBLmNf-TuB_bpae0roR3SSEJy40ssJR5eI",BASE_URL:"/HW-Vue-week6/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_API_URL:h,VITE_API_PATH:b}=Kt,Wt={data(){return{products:[],tempProduct:{imagesUrl:[]},pages:{},modalProduct:null,delModalProduct:null,isNew:!1}},mounted(){this.getData()},methods:{getData(d=1){const o=`${h}/api/${b}/admin/products?page=${d}`;f.get(o).then(l=>{console.log(l),this.products=l.data.products,this.pages=l.data.pagination}).catch(l=>{_.toastTop(l.response.data.message,"error")})},updateProduct(){let d=`${h}/api/${b}/admin/product`,o="post";this.isNew||(d=`${h}/api/${b}/admin/product/${this.tempProduct.id}`,o="put"),f[o](d,{data:this.tempProduct}).then(l=>{_.toastTop(l.data.message,"success"),this.getData(),this.$refs.pModal.closeModal()}).catch(l=>{_.toastTop(l.response.data.message,"error")})},openModal(d,o){d==="new"?(this.tempProduct={imagesUrl:[]},this.isNew=!0,this.$refs.pModal.openModal()):d==="edit"?(this.tempProduct={...o},this.tempProduct.imagesUrl||(this.tempProduct.imagesUrl=[]),this.isNew=!1,this.$refs.pModal.openModal()):d==="delete"&&(this.tempProduct={...o},this.$refs.delModal.openDelModal())},delProduct(){const d=`${h}/api/${b}/admin/product/${this.tempProduct.id}`;f.delete(d).then(o=>{_.toastTop(o.data.message,"success"),this.$refs.delModal.closeDelModal(),this.getData()}).catch(o=>{_.toastTop(o.response.data.message,"error")})}},components:{PaginationComponent:D,ProductModal:Et,DelModal:zt}},Yt=t("h2",{class:"mt-2"},"產品管理",-1),qt={class:"container"},Gt={class:"text-end mt-4"},Qt={class:"table mt-4"},Xt=t("thead",null,[t("tr",null,[t("th",{width:"90"},"分類"),t("th",{width:"120"},"產品名稱"),t("th",{width:"120",class:"text-end"},"原價"),t("th",{width:"120",class:"text-end"},"售價"),t("th",{width:"120",class:"text-center"},"是否啟用"),t("th",{width:"120",class:"text-center"},"編輯")])],-1),Zt={class:"text-end"},to={class:"text-end"},oo={class:"text-center"},eo={key:0,class:"text-success"},so={key:1},lo={class:"text-center"},no={class:"btn-group"},io=["onClick"],co=["onClick"];function ro(d,o,l,x,e,u){const s=g("Pagination-Component"),m=g("Product-Modal"),P=g("Del-Modal");return n(),i(y,null,[Yt,t("div",qt,[t("div",Gt,[t("button",{class:"btn btn-secondary",onClick:o[0]||(o[0]=a=>u.openModal("new"))},"建立新的產品")]),t("table",Qt,[Xt,t("tbody",null,[(n(!0),i(y,null,V(e.products,a=>(n(),i("tr",{key:a.id},[t("td",null,p(a.category),1),t("td",null,p(a.title),1),t("td",Zt,p(a.origin_price),1),t("td",to,p(a.price),1),t("td",oo,[a.is_enabled?(n(),i("span",eo,"啟用")):(n(),i("span",so,"未啟用"))]),t("td",lo,[t("div",no,[t("button",{type:"button",class:"btn btn-outline-secondary btn-sm",onClick:C=>u.openModal("edit",a)}," 編輯 ",8,io),t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:C=>u.openModal("delete",a)}," 刪除 ",8,co)])])]))),128))])]),v(s,{pages:e.pages,onChangePage:u.getData},null,8,["pages","onChangePage"])]),v(m,{"temp-product":e.tempProduct,"update-product":u.updateProduct,"is-New":e.isNew,ref:"pModal"},null,8,["temp-product","update-product","is-New"]),v(P,{"temp-product":e.tempProduct,"del-product":u.delProduct,ref:"delModal"},null,8,["temp-product","del-product"])],64)}const _o=M(Wt,[["render",ro]]);export{_o as default};
