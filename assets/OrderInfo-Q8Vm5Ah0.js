import{_ as I,m as N,a as T,r as _,o as r,c as d,b as e,h as n,i as b,F as v,f as y,t as c,d as a,e as S,w as x,j as $,q as p,g as A,v as P}from"./index-ncP-AMKL.js";import{c as w}from"./cartStore-R_uk6mXK.js";var U={VITE_API_URL:"https://ec-course-api.hexschool.io/v2",VITE_API_PATH:"js23",BASE_URL:"/HW-Vue-week6/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_API_URL:k,VITE_API_PATH:C}=U,E={data(){return{user:{name:"",email:"",tel:"",address:""},message:"",coupon:"",orderId:""}},mounted(){this.getCart()},computed:{...N(w,["carts","order_total","deliveryFee","final_total"])},methods:{...T(w,["getCart","removeCartsAll","delCartItem","changeCartQty"]),getCoupon(){this.coupon="vegan032024",this.getCart()},addCoupon(){const s={code:this.coupon};this.$http.post(`${k}/api/${C}/coupon`,{data:s}).then(t=>{alert("get coupon"),this.getCart()}).catch(t=>{console.log(t)})},isPhone(s){return/^(09)[0-9]{8}$/.test(s)?!0:"需為正確的手機號碼格式"},toProducts(){this.$router.push("/products")},createOrder(){if(this.carts.length){const s={user:this.user,message:this.message};this.$http.post(`${k}/api/${C}/order`,{data:s}).then(t=>{alert("送出成功"),this.getCart(),this.$refs.form.resetForm(),this.orderId=t.data.orderId,this.$router.push(`/checkout/${this.orderId}`)}).catch(t=>{console.log(t),alert("送出失敗")})}else alert("購物車是空的")}}},q={class:"container"},F={class:"mt-2"},R={class:"breadcrumb"},L={class:"breadcrumb-item"},D={class:"breadcrumb-item"},O=e("li",{class:"breadcrumb-item"},"填寫訂單資訊",-1),B={class:"my-4"},z={key:0},H=$('<div class="row justify-content-center mb-10"><div class="col-3 border-bottom border-5 border-primary"><div class="d-flex flex-column align-items-center"><div class="rounded-circle bg-primary text-white d-flex align-items-center justify-content-center mb-1" style="width:20px;height:20px;"> 1 </div><p class="text-primary mb-2 fw-bold">填寫資料</p></div></div><div class="col-3 border-bottom border-5 border-gray"><div class="d-flex flex-column align-items-center"><div class="rounded-circle bg-gray-3 text-light d-flex align-items-center justify-content-center mb-1" style="width:20px;height:20px;"> 2 </div><p class="text-gray-3 mb-2 fw-bold">確認付款</p></div></div><div class="col-3 border-bottom border-5 border-gray"><div class="d-flex flex-column align-items-center"><div class="rounded-circle bg-gray-3 text-light d-flex align-items-center justify-content-center mb-1" style="width:20px;height:20px;"> 3 </div><p class="text-gray-3 mb-2 fw-bold">完成訂購</p></div></div></div>',1),M={class:"row justify-content-center"},Q={class:"col-lg-5 mb-5 mb-lg-0"},W={class:"d-flex justify-content-between align-items-center"},G=e("p",{class:"d-flex align-items-center text-dark mb-6"},[e("span",{class:"material-icons fs-6 me-2"}," arrow_back_ios "),a("繼續購物 ")],-1),J={class:"table align-middle"},K=e("tr",{class:"border-bottom"},null,-1),X={class:"d-flex align-items-center justify-content-between gap-5 py-4 px-0"},Y={class:"d-flex align-items-center"},Z=["onClick"],ee=e("i",{class:"bi bi-x-square fs-5 text-gray-600"},null,-1),se=[ee],te=["src"],oe={class:"d-flex align-items-center justify-content-between w-75"},le={class:"mb-1"},ne={class:"mb-1"},ae={style:{width:"80px"}},ie=["onUpdate:modelValue","onChange","disabled"],re=["value"],de={class:"mb-0 text-end"},ce={class:"d-flex align-items center gap-1 mb-2"},me=e("i",{class:"bi bi-tags-fill fs-5"},null,-1),ue=e("label",{class:"form-label"},[a("結帳輸入 "),e("span",{class:"text-primary fw-bold fs-6"},"vegan032024"),a(" 即享有9折本月優惠")],-1),_e={class:"input-group input-group-sm mb-3"},be=["value"],pe={class:"d-flex justify-content-between"},he=e("p",{class:"fs-6 mb-2"},"小計",-1),fe={class:"fs-6 mb-2 fw-bold"},ge={class:"d-flex justify-content-between"},ve={class:"fs-6 mb-2"},ye={key:0,class:"text-danger"},xe={key:1,class:"text-primary"},we={class:"fs-6 mb-2 fw-bold"},ke={class:"d-flex justify-content-between"},Ce=e("p",{class:"fs-6 mb-2"},"總計",-1),Ve={class:"fs-6 mb-2 fw-bold"},je={key:0,class:"d-flex justify-content-between mb-2"},Ie=e("p",{class:"fs-6 mb-2 text-danger"},"折扣價",-1),Ne={class:"fs-6 mb-2 fw-bold text-danger"},Te={class:"col-lg-5"},Se={class:"card border-0 bg-light-green py-4 p-lg-2 ms-lg-4"},$e={class:"card-body"},Ae=e("h2",{class:"h5 text-center mb-4"},"訂單連絡資訊",-1),Pe={class:"mb-4"},Ue=e("label",{for:"name",class:"form-label"},[a("姓名"),e("span",{class:"text-danger"},"*")],-1),Ee={class:"mb-4"},qe=e("label",{for:"phone",class:"form-label"},[a("手機"),e("span",{class:"text-danger"},"*")],-1),Fe={class:"mb-3"},Re=e("label",{for:"email",class:"form-label"},[a("信箱"),e("span",{class:"text-danger"},"*")],-1),Le={class:"mb-4"},De=e("label",{for:"address",class:"form-label"},[a("外送地址"),e("span",{class:"text-danger"},"*")],-1),Oe={class:"mb-4"},Be=e("label",{for:"message",class:"form-label"},"訂單備註",-1),ze=e("div",{class:"mb-4"},[e("p",null,[a("註："),e("span",{class:"text-danger"},"*"),a("為必填欄位")])],-1),He=e("button",{type:"submit",class:"btn btn-secondary w-100"},"送出訂單",-1),Me={key:1,class:"text-center"},Qe=e("i",{class:"bi bi-cart4 fs-1 text-primary"},null,-1),We=e("h3",{class:"fs-5 mb-6 mt-3"},"目前購物車是空的喔! 再去選購吧~",-1);function Ge(s,t,Je,Ke,i,m){var g;const f=_("RouterLink"),u=_("v-field"),h=_("error-message"),V=_("v-form"),j=_("router-link");return r(),d("div",q,[e("nav",F,[e("ol",R,[e("li",L,[n(f,{to:"/",class:"text-primary"},{default:b(()=>[a("首頁")]),_:1})]),e("li",D,[n(f,{to:"/products",class:"text-primary"},{default:b(()=>[a("線上訂餐")]),_:1})]),O])]),e("main",B,[(g=s.carts)!=null&&g.length?(r(),d("div",z,[H,e("div",M,[e("section",Q,[e("div",W,[n(f,{to:"/products"},{default:b(()=>[G]),_:1}),e("button",{type:"button",class:"btn btn-sm btn-outline-danger fs-7",onClick:t[0]||(t[0]=(...o)=>s.removeCartsAll&&s.removeCartsAll(...o))}," 清空購物車 ")]),e("table",J,[e("tbody",null,[K,(r(!0),d(v,null,y(s.carts,o=>(r(),d("tr",{key:o.id},[e("td",X,[e("div",Y,[e("a",{role:"button",class:p(["btn p-0 me-3",{disabled:s.loadingStatus===o.id}]),onClick:x(l=>s.delCartItem(o.id),["prevent"]),style:{"border-color":"transparent"}},se,10,Z),e("img",{src:o.product.imageUrl,class:"object-fit-cover flex-shrink-0",width:"80",height:"80",alt:"cart.product.title"},null,8,te)]),e("div",oe,[e("div",null,[e("p",le,c(o.product.title),1),e("p",ne," NT$"+c(s.$filters.currency(o.product.price))+" / "+c(o.product.unit),1),e("div",ae,[A(e("select",{"onUpdate:modelValue":l=>o.qty=l,class:"form-select form-select-sm",onChange:l=>s.changeCartQty(o),disabled:s.loadingStatus===o.id},[(r(),d(v,null,y(20,l=>e("option",{key:l+1234,value:l},c(l),9,re)),64))],40,ie),[[P,o.qty]])])]),e("p",de,"NT$"+c(s.$filters.currency(o.total)),1)])])]))),128))])]),e("div",ce,[me,ue,e("button",{type:"button",class:"btn btn-outline-dark btn-sm py-0 mb-2 ms-1 flex-shrink-0",style:{"font-size":"12px"},onClick:t[1]||(t[1]=(...o)=>m.getCoupon&&m.getCoupon(...o))}," 取得優惠 ")]),e("div",_e,[e("input",{type:"text",class:"form-control",placeholder:"請輸入優惠碼","aria-label":"請輸入優惠碼",value:i.coupon,"aria-describedby":"button-addon2"},null,8,be),e("button",{class:"btn btn-outline-primary",type:"button",id:"button-addon2",onClick:t[2]||(t[2]=(...o)=>m.addCoupon&&m.addCoupon(...o))}," 套用 ")]),e("div",pe,[he,e("p",fe,"NT$"+c(s.$filters.currency(this.order_total)),1)]),e("div",ge,[e("p",ve,[a(" 運費 "),s.order_total<300?(r(),d("small",ye,"(消費滿 $300 可享免運優惠)")):(r(),d("small",xe,"(已達免運門檻！)"))]),e("p",we,"NT$"+c(s.deliveryFee),1)]),e("div",ke,[Ce,e("p",Ve,"NT$"+c(s.$filters.currency(s.order_total+s.deliveryFee)),1)]),s.order_total!==s.final_total?(r(),d("div",je,[Ie,e("p",Ne," NT$"+c(s.$filters.currency(s.final_total+s.deliveryFee)),1)])):S("",!0)]),e("section",Te,[e("div",Se,[e("div",$e,[n(V,{onSubmit:m.createOrder,ref:"form"},{default:b(({errors:o})=>[Ae,e("div",Pe,[Ue,n(u,{id:"name",name:"姓名",type:"text",class:p(["form-control",{"is-invalid":o.姓名}]),placeholder:"請填寫真實姓名",rules:"required",modelValue:i.user.name,"onUpdate:modelValue":t[3]||(t[3]=l=>i.user.name=l)},null,8,["class","modelValue"]),n(h,{name:"姓名",class:"invalid-feedback"})]),e("div",Ee,[qe,n(u,{id:"phone",name:"手機",type:"tel",class:p(["form-control",{"is-invalid":o.手機}]),placeholder:"0912345678",rules:m.isPhone,modelValue:i.user.tel,"onUpdate:modelValue":t[4]||(t[4]=l=>i.user.tel=l)},null,8,["class","rules","modelValue"]),n(h,{name:"手機",class:"invalid-feedback"})]),e("div",Fe,[Re,n(u,{id:"email",name:"信箱",type:"email",class:p(["form-control",{"is-invalid":o.信箱}]),placeholder:"example@email.com",rules:"email|required",modelValue:i.user.email,"onUpdate:modelValue":t[5]||(t[5]=l=>i.user.email=l)},null,8,["class","modelValue"]),n(h,{name:"信箱",class:"invalid-feedback"})]),e("div",Le,[De,n(u,{id:"address",name:"外送地址",type:"text",class:p(["form-control",{"is-invalid":o.外送地址}]),placeholder:"請填寫地址",rules:"required",modelValue:i.user.address,"onUpdate:modelValue":t[6]||(t[6]=l=>i.user.address=l)},null,8,["class","modelValue"]),n(h,{name:"外送地址",class:"invalid-feedback"})]),e("div",Oe,[Be,n(u,{as:"textarea",id:"message",name:"訂單備註",class:"form-control",rows:"3",modelValue:i.message,"onUpdate:modelValue":t[7]||(t[7]=l=>i.message=l),style:{resize:"none"}},null,8,["modelValue"])]),ze,He]),_:1},8,["onSubmit"])])])])])])):(r(),d("div",Me,[Qe,We,n(j,{to:"",onClick:t[8]||(t[8]=x(o=>m.toProducts(),["prevent"])),class:"btn btn-secondary fs-lg-5 px-3 py-2 px-lg-6"},{default:b(()=>[a("前往訂餐")]),_:1})]))])])}const Ze=I(E,[["render",Ge]]);export{Ze as default};
