import{_ as v,o as r,c as n,b as e,g as a,L as _,N as w,F as h,f as M,t as i,d as x,I as b,r as f,h as O,G as $,e as T}from"./index-O13lh_ht.js";import{A as p}from"./swal-n18gMqCC.js";import{m as k}from"./modalMixin-kjRVx_Rw.js";import{P as I}from"./PaginationComponent-ftOaNWf4.js";import"./sweetalert2.all-weXnpXmy.js";const U={props:["tempOrder","updatePaid"],data(){return{modalOrder:null,editOrder:{user:{}},modal:"",isPaid:!1}},emits:["update-paid"],mixins:[k],methods:{},mounted(){},watch:{tempOrder(){this.editOrder=this.tempOrder}}},A={id:"modalOrder",ref:"modal",class:"modal fade",tabindex:"-1","aria-labelledby":"orderModalLabel","aria-hidden":"true"},D={class:"modal-dialog modal-xl",style:{width:"900px"}},E={class:"modal-content border-0"},L=e("div",{class:"modal-header bg-dark text-white"},[e("h5",{id:"orderModalLabel",class:"modal-title"},[e("span",null,"訂單內容")]),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),R={class:"modal-body"},S={class:"row"},B=e("h3",{class:"col-md-2"},"訂單資訊",-1),N={class:"row"},H={class:"col-md-4"},z=e("label",{for:"orderId",class:"form-label"},"訂單編號",-1),F={class:"col-md-3"},J=e("label",{for:"create_at",class:"form-label"},"訂購日期",-1),j={class:"col-md-2"},q=e("label",{for:"num",class:"form-label"},"數量",-1),G={class:"col-md-4"},K=e("label",{class:"form-check-label"},"帳款狀態",-1),W={class:"form-check"},Y={class:"form-check-label",for:"flexCheckDefault"},Q={key:0},X={key:1},Z={class:"row mt-5"},ee=e("h3",null,"會員資訊",-1),te={class:"mb-3 col-md-2"},se=e("label",{for:"name",class:"form-label"},"名稱",-1),oe={class:"mb-3 col-md-2"},de=e("label",{for:"phone",class:"form-label"},"電話",-1),le={class:"mb-3 col-md-3"},re=e("label",{for:"email",class:"form-label"},"電子信箱",-1),ne={class:"mb-3 col-md-8"},ae=e("label",{for:"address",class:"form-label"},"寄送地址",-1),ie={class:"row mt-5"},ce=e("h3",null,"訂購商品",-1),me={class:"px-3"},_e={class:"table align-middle table-sm",style:{width:"800px"}},ue=e("thead",{class:"table-light"},[e("tr",null,[e("td",null,"商品編號"),e("td",null,"商品名稱"),e("td",{class:"text-end"},"商品數量"),e("td",{class:"text-end"},"小計")])],-1),pe={class:"text-end"},he={class:"text-end"},be=e("td",{colspan:"3",class:"text-end"},"總計",-1),fe={class:"text-end"},Oe={class:"modal-footer"},ye=e("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 關閉 ",-1);function ge(l,t,d,u,s,c){return r(),n("div",A,[e("div",D,[e("div",E,[L,e("div",R,[e("div",S,[e("div",null,[B,e("div",N,[e("div",H,[z,a(e("input",{id:"orderId","onUpdate:modelValue":t[0]||(t[0]=o=>s.editOrder.id=o),type:"text",class:"form-control",readonly:""},null,512),[[_,s.editOrder.id]])]),e("div",F,[J,a(e("input",{id:"create_at","onUpdate:modelValue":t[1]||(t[1]=o=>s.editOrder.create_at=o),type:"text",class:"form-control",readonly:""},null,512),[[_,s.editOrder.create_at]])]),e("div",j,[q,a(e("input",{id:"num","onUpdate:modelValue":t[2]||(t[2]=o=>s.editOrder.num=o),type:"text",class:"form-control",readonly:""},null,512),[[_,s.editOrder.num]])]),e("div",G,[K,e("div",W,[a(e("input",{class:"form-check-input",type:"checkbox",id:"flexCheckDefault","onUpdate:modelValue":t[3]||(t[3]=o=>s.editOrder.is_paid=o)},null,512),[[w,s.editOrder.is_paid]]),e("label",Y,[s.editOrder.is_paid?(r(),n("span",Q,"已付款")):(r(),n("span",X,"未付款"))])])])]),e("div",Z,[ee,e("div",te,[se,a(e("input",{id:"name","onUpdate:modelValue":t[4]||(t[4]=o=>s.editOrder.user.name=o),type:"text",class:"form-control",readonly:""},null,512),[[_,s.editOrder.user.name]])]),e("div",oe,[de,a(e("input",{id:"phone","onUpdate:modelValue":t[5]||(t[5]=o=>s.editOrder.user.tel=o),type:"text",class:"form-control",readonly:""},null,512),[[_,s.editOrder.user.tel]])]),e("div",le,[re,a(e("input",{id:"email","onUpdate:modelValue":t[6]||(t[6]=o=>s.editOrder.user.email=o),type:"text",class:"form-control",readonly:""},null,512),[[_,s.editOrder.user.email]])])]),e("div",ne,[ae,a(e("input",{id:"address","onUpdate:modelValue":t[7]||(t[7]=o=>s.editOrder.user.address=o),type:"text",class:"form-control",readonly:""},null,512),[[_,s.editOrder.user.address]])]),e("div",ie,[ce,e("div",me,[e("table",_e,[ue,e("tbody",null,[(r(!0),n(h,null,M(s.editOrder.products,o=>(r(),n("tr",{key:o.id},[e("td",null,i(o.id),1),e("td",null,i(o.product.title),1),e("td",pe,i(o.qty),1),e("td",he,i(o.total),1)]))),128))]),e("tfoot",null,[e("tr",null,[be,e("td",fe,i(s.editOrder.total),1)])])])])])])])]),e("div",Oe,[ye,e("button",{type:"button",class:"btn btn-secondary",onClick:t[8]||(t[8]=o=>l.$emit("update-paid",s.editOrder))}," 修改付款狀態 ")])])])],512)}const ve=v(U,[["render",ge]]),xe={props:["tempOrder","delOrder"],data(){return{modalOrderDel:null}},mixins:[k],methods:{},mounted(){}},Me={id:"delOrderModal",ref:"modal",class:"modal fade",tabindex:"-1","aria-labelledby":"delOrderModalLabel","aria-hidden":"true"},ke={class:"modal-dialog"},Ce={class:"modal-content border-0"},Pe=e("div",{class:"modal-header bg-danger text-white"},[e("h5",{id:"delOrderModalLabel",class:"modal-title"},[e("span",null,"刪除訂單")]),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Ve={class:"modal-body"},we={class:"text-danger"},$e={class:"modal-footer"},Te=e("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function Ie(l,t,d,u,s,c){return r(),n("div",Me,[e("div",ke,[e("div",Ce,[Pe,e("div",Ve,[x(" 是否刪除訂單編號 "),e("strong",we,i(d.tempOrder.id),1),x(" 訂單(刪除後將無法恢復)。 ")]),e("div",$e,[Te,e("button",{type:"button",class:"btn btn-danger",onClick:t[0]||(t[0]=(...o)=>d.delOrder&&d.delOrder(...o))},"確認刪除")])])])],512)}const Ue=v(xe,[["render",Ie]]);var Ae={VITE_API_URL:"https://ec-course-api.hexschool.io/v2",VITE_API_PATH:"js23",VITE_MAP_KEY:"AIzaSyBLmNf-TuB_bpae0roR3SSEJy40ssJR5eI",BASE_URL:"/HW-Vue-week6/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_API_URL:y,VITE_API_PATH:g}=Ae,De={components:{OrderModal:ve,DelOrderModal:Ue,PaginationComponent:I},data(){return{orders:[],currentPage:1,tempOrder:{user:{}},pages:{}}},mounted(){this.getOrders()},methods:{getOrders(l=1){const t=`${y}/api/${g}/admin/orders?page=${l}`;b.get(t).then(d=>{this.orders=d.data.orders,this.pages=d.data.pagination}).catch(d=>{p.toastTop(d.response.data.message,"error")})},openModal(l,t){l==="edit"?(this.tempOrder={...t},console.log(this.tempOrder),this.$refs.orderModal.openModal()):l==="delete"&&(this.tempOrder={...t},this.$refs.delOrderModal.openModal())},updatePaid(l){const t=`${y}/api/${g}/admin/order/${l.id}`,d={is_paid:l.is_paid};b.put(t,{data:d}).then(u=>{p.toastTop(u.data.message,"success"),this.$refs.orderModal.closeModal(),this.getOrders(this.currentPage)}).catch(u=>{p.toastTop(u.response.data.message)})},delOrder(){const l=`${y}/api/${g}/admin/order/${this.tempOrder.id}`;b.delete(l).then(t=>{p.toastTop(t.data.message,"success"),this.$refs.delOrderModal.closeModal(),this.getOrders(this.currentPage)}).catch(t=>{console.log(t),p.toastTop(t.response.data.message,"error")})}}},Ee=e("h2",{class:"mt-2"},"訂單管理",-1),Le={class:"container"},Re={class:"row"},Se={class:"table mt-4"},Be=e("thead",null,[e("tr",null,[e("th",{width:"120"},"訂單編號"),e("th",{width:"120"},"會員名稱"),e("th",{width:"120"},"帳款狀態"),e("th",{width:"120"},"編輯訂單"),e("th",{width:"120"},"刪除訂單")])],-1),Ne={key:0,class:"text-success"},He={key:1},ze=["onClick"],Fe=["onClick"];function Je(l,t,d,u,s,c){const o=f("Pagination-Component"),C=f("Order-Modal"),P=f("Del-Order-Modal");return r(),n(h,null,[Ee,e("div",Le,[e("div",Re,[e("table",Se,[Be,e("tbody",null,[(r(!0),n(h,null,M(s.orders,m=>(r(),n(h,{key:m.id},[s.orders.length?(r(),n("tr",{key:0,class:$({"text-secondary":!m.is_paid})},[e("td",null,i(m.id),1),e("td",null,i(m.user.name),1),e("td",null,[m.is_paid?(r(),n("span",Ne,"已付款")):(r(),n("span",He,"未付款"))]),e("td",null,[e("button",{type:"button",class:"btn btn-outline-secondary btn-sm",onClick:V=>c.openModal("edit",m)}," 編輯 ",8,ze)]),e("td",null,[e("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:V=>c.openModal("delete",m)}," 刪除 ",8,Fe)])],2)):T("",!0)],64))),128))])])]),O(o,{pages:s.pages,onChangePage:c.getOrders},null,8,["pages","onChangePage"]),O(C,{ref:"orderModal","temp-order":s.tempOrder,onUpdatePaid:c.updatePaid},null,8,["temp-order","onUpdatePaid"]),O(P,{ref:"delOrderModal","temp-order":s.tempOrder,"del-order":c.delOrder},null,8,["temp-order","del-order"])])],64)}const Ye=v(De,[["render",Je]]);export{Ye as default};
