import{_ as y,o as l,c as r,b as e,g as a,L as _,N as $,F as h,f as g,t as i,d as v,H as b,r as x,h as M,I as w,e as P}from"./index-3bceno1i.js";import{A as p}from"./swal-tijMSQwW.js";import{m as k}from"./modalMixin-_Nd4Yv-a.js";import"./sweetalert2.all-qsh1ECf1.js";const T={props:["tempOrder","updatePaid"],data(){return{modalOrder:null,editOrder:{user:{}},modal:"",isPaid:!1}},emits:["update-paid"],mixins:[k],methods:{},mounted(){},watch:{tempOrder(){this.editOrder=this.tempOrder}}},I={id:"modalOrder",ref:"modal",class:"modal fade",tabindex:"-1","aria-labelledby":"orderModalLabel","aria-hidden":"true"},U={class:"modal-dialog modal-xl",style:{width:"900px"}},A={class:"modal-content border-0"},D=e("div",{class:"modal-header bg-dark text-white"},[e("h5",{id:"orderModalLabel",class:"modal-title"},[e("span",null,"訂單內容")]),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),E={class:"modal-body"},L={class:"row"},R=e("h3",{class:"col-md-2"},"訂單資訊",-1),S={class:"row"},B={class:"col-md-4"},N=e("label",{for:"orderId",class:"form-label"},"訂單編號",-1),H={class:"col-md-3"},z=e("label",{for:"create_at",class:"form-label"},"訂購日期",-1),F={class:"col-md-2"},J=e("label",{for:"num",class:"form-label"},"數量",-1),j={class:"col-md-4"},q=e("label",{class:"form-check-label"},"帳款狀態",-1),K={class:"form-check"},W={class:"form-check-label",for:"flexCheckDefault"},Y={key:0},G={key:1},Q={class:"row mt-5"},X=e("h3",null,"會員資訊",-1),Z={class:"mb-3 col-md-2"},ee=e("label",{for:"name",class:"form-label"},"名稱",-1),te={class:"mb-3 col-md-2"},se=e("label",{for:"phone",class:"form-label"},"電話",-1),de={class:"mb-3 col-md-3"},oe=e("label",{for:"email",class:"form-label"},"電子信箱",-1),le={class:"mb-3 col-md-8"},re=e("label",{for:"address",class:"form-label"},"寄送地址",-1),ne={class:"row mt-5"},ae=e("h3",null,"訂購商品",-1),ie={class:"px-3"},ce={class:"table align-middle table-sm",style:{width:"800px"}},_e=e("thead",{class:"table-light"},[e("tr",null,[e("td",null,"商品編號"),e("td",null,"商品名稱"),e("td",{class:"text-end"},"商品數量"),e("td",{class:"text-end"},"小計")])],-1),me={class:"text-end"},ue={class:"text-end"},pe=e("td",{colspan:"3",class:"text-end"},"總計",-1),he={class:"text-end"},be={class:"modal-footer"},fe=e("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 關閉 ",-1);function Oe(o,t,n,m,s,u){return l(),r("div",I,[e("div",U,[e("div",A,[D,e("div",E,[e("div",L,[e("div",null,[R,e("div",S,[e("div",B,[N,a(e("input",{id:"orderId","onUpdate:modelValue":t[0]||(t[0]=d=>s.editOrder.id=d),type:"text",class:"form-control",readonly:""},null,512),[[_,s.editOrder.id]])]),e("div",H,[z,a(e("input",{id:"create_at","onUpdate:modelValue":t[1]||(t[1]=d=>s.editOrder.create_at=d),type:"text",class:"form-control",readonly:""},null,512),[[_,s.editOrder.create_at]])]),e("div",F,[J,a(e("input",{id:"num","onUpdate:modelValue":t[2]||(t[2]=d=>s.editOrder.num=d),type:"text",class:"form-control",readonly:""},null,512),[[_,s.editOrder.num]])]),e("div",j,[q,e("div",K,[a(e("input",{class:"form-check-input",type:"checkbox",id:"flexCheckDefault","onUpdate:modelValue":t[3]||(t[3]=d=>s.editOrder.is_paid=d)},null,512),[[$,s.editOrder.is_paid]]),e("label",W,[s.editOrder.is_paid?(l(),r("span",Y,"已付款")):(l(),r("span",G,"未付款"))])])])]),e("div",Q,[X,e("div",Z,[ee,a(e("input",{id:"name","onUpdate:modelValue":t[4]||(t[4]=d=>s.editOrder.user.name=d),type:"text",class:"form-control",readonly:""},null,512),[[_,s.editOrder.user.name]])]),e("div",te,[se,a(e("input",{id:"phone","onUpdate:modelValue":t[5]||(t[5]=d=>s.editOrder.user.tel=d),type:"text",class:"form-control",readonly:""},null,512),[[_,s.editOrder.user.tel]])]),e("div",de,[oe,a(e("input",{id:"email","onUpdate:modelValue":t[6]||(t[6]=d=>s.editOrder.user.email=d),type:"text",class:"form-control",readonly:""},null,512),[[_,s.editOrder.user.email]])])]),e("div",le,[re,a(e("input",{id:"address","onUpdate:modelValue":t[7]||(t[7]=d=>s.editOrder.user.address=d),type:"text",class:"form-control",readonly:""},null,512),[[_,s.editOrder.user.address]])]),e("div",ne,[ae,e("div",ie,[e("table",ce,[_e,e("tbody",null,[(l(!0),r(h,null,g(s.editOrder.products,d=>(l(),r("tr",{key:d.id},[e("td",null,i(d.id),1),e("td",null,i(d.product.title),1),e("td",me,i(d.qty),1),e("td",ue,i(d.total),1)]))),128))]),e("tfoot",null,[e("tr",null,[pe,e("td",he,i(s.editOrder.total),1)])])])])])])])]),e("div",be,[fe,e("button",{type:"button",class:"btn btn-secondary",onClick:t[8]||(t[8]=d=>o.$emit("update-paid",s.editOrder))}," 修改付款狀態 ")])])])],512)}const ye=y(T,[["render",Oe]]),ve={props:["tempOrder","delOrder"],data(){return{modalOrderDel:null}},mixins:[k],methods:{},mounted(){}},xe={id:"delOrderModal",ref:"modal",class:"modal fade",tabindex:"-1","aria-labelledby":"delOrderModalLabel","aria-hidden":"true"},Me={class:"modal-dialog"},ge={class:"modal-content border-0"},ke=e("div",{class:"modal-header bg-danger text-white"},[e("h5",{id:"delOrderModalLabel",class:"modal-title"},[e("span",null,"刪除訂單")]),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Ve={class:"modal-body"},Ce={class:"text-danger"},$e={class:"modal-footer"},we=e("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function Pe(o,t,n,m,s,u){return l(),r("div",xe,[e("div",Me,[e("div",ge,[ke,e("div",Ve,[v(" 是否刪除訂單編號 "),e("strong",Ce,i(n.tempOrder.id),1),v(" 訂單(刪除後將無法恢復)。 ")]),e("div",$e,[we,e("button",{type:"button",class:"btn btn-danger",onClick:t[0]||(t[0]=(...d)=>n.delOrder&&n.delOrder(...d))},"確認刪除")])])])],512)}const Te=y(ve,[["render",Pe]]);var Ie={VITE_API_URL:"https://ec-course-api.hexschool.io/v2",VITE_API_PATH:"js23",VITE_MAP_KEY:"AIzaSyBLmNf-TuB_bpae0roR3SSEJy40ssJR5eI",BASE_URL:"/HW-Vue-week6/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_API_URL:f,VITE_API_PATH:O}=Ie,Ue={components:{OrderModal:ye,DelOrderModal:Te},data(){return{orders:[],currentPage:1,tempOrder:{user:{}}}},mounted(){this.getOrders()},methods:{getOrders(){const o=`${f}/api/${O}/admin/orders`;b.get(o).then(t=>{this.orders=t.data.orders}).catch(t=>{p.toastTop(t.response.data.message,"error")})},openModal(o,t){o==="edit"?(this.tempOrder={...t},console.log(this.tempOrder),this.$refs.orderModal.openModal()):o==="delete"&&(this.tempOrder={...t},this.$refs.delOrderModal.openModal())},updatePaid(o){const t=`${f}/api/${O}/admin/order/${o.id}`,n={is_paid:o.is_paid};b.put(t,{data:n}).then(m=>{p.toastTop(m.data.message,"success"),this.$refs.orderModal.closeModal(),this.getOrders(this.currentPage)}).catch(m=>{p.toastTop(m.response.data.message)})},delOrder(){const o=`${f}/api/${O}/admin/order/${this.tempOrder.id}`;b.delete(o).then(t=>{p.toastTop(t.data.message,"success"),this.$refs.delOrderModal.closeModal(),this.getOrders(this.currentPage)}).catch(t=>{console.log(t),p.toastTop(t.response.data.message,"error")})}}},Ae=e("h2",{class:"mt-2"},"訂單管理",-1),De={class:"container"},Ee={class:"row"},Le={class:"table mt-4"},Re=e("thead",null,[e("tr",null,[e("th",{width:"120"},"訂單編號"),e("th",{width:"120"},"會員名稱"),e("th",{width:"120"},"帳款狀態"),e("th",{width:"120"},"編輯訂單"),e("th",{width:"120"},"刪除訂單")])],-1),Se={key:0,class:"text-success"},Be={key:1},Ne=["onClick"],He=["onClick"];function ze(o,t,n,m,s,u){const d=x("Order-Modal"),V=x("Del-Order-Modal");return l(),r(h,null,[Ae,e("div",De,[e("div",Ee,[e("table",Le,[Re,e("tbody",null,[(l(!0),r(h,null,g(s.orders,c=>(l(),r(h,{key:c.id},[s.orders.length?(l(),r("tr",{key:0,class:w({"text-secondary":!c.is_paid})},[e("td",null,i(c.id),1),e("td",null,i(c.user.name),1),e("td",null,[c.is_paid?(l(),r("span",Se,"已付款")):(l(),r("span",Be,"未付款"))]),e("td",null,[e("button",{type:"button",class:"btn btn-outline-secondary btn-sm",onClick:C=>u.openModal("edit",c)}," 編輯 ",8,Ne)]),e("td",null,[e("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:C=>u.openModal("delete",c)}," 刪除 ",8,He)])],2)):P("",!0)],64))),128))])])]),M(d,{ref:"orderModal","temp-order":s.tempOrder,onUpdatePaid:u.updatePaid},null,8,["temp-order","onUpdatePaid"]),M(V,{ref:"delOrderModal","temp-order":s.tempOrder,"del-order":u.delOrder},null,8,["temp-order","del-order"])])],64)}const Ke=y(Ue,[["render",ze]]);export{Ke as default};
