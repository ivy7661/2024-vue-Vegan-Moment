import{_ as O,o as l,c as r,b as e,g as a,u as _,z as V,F as p,f as M,t as i,d as y,l as h,r as v,h as x,q as $,e as w}from"./index-A52Ioxsw.js";import{m as g}from"./modalMixin-0ksQEDZU.js";const P={props:["tempOrder","updatePaid"],data(){return{modalOrder:null,editOrder:{user:{}},modal:"",isPaid:!1}},emits:["update-paid"],mixins:[g],methods:{},mounted(){},watch:{tempOrder(){this.editOrder=this.tempOrder}}},U={id:"modalOrder",ref:"modal",class:"modal fade",tabindex:"-1","aria-labelledby":"orderModalLabel","aria-hidden":"true"},D={class:"modal-dialog modal-xl",style:{width:"900px"}},I={class:"modal-content border-0"},A=e("div",{class:"modal-header bg-dark text-white"},[e("h5",{id:"orderModalLabel",class:"modal-title"},[e("span",null,"訂單內容")]),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),E={class:"modal-body"},L={class:"row"},T=e("h3",{class:"col-md-2"},"訂單資訊",-1),R={class:"row"},B={class:"col-md-4"},N=e("label",{for:"orderId",class:"form-label"},"訂單編號",-1),S={class:"col-md-3"},H=e("label",{for:"create_at",class:"form-label"},"訂購日期",-1),q={class:"col-md-2"},z=e("label",{for:"num",class:"form-label"},"數量",-1),F={class:"col-md-4"},j=e("label",{class:"form-check-label"},"帳款狀態",-1),W={class:"form-check"},G={class:"form-check-label",for:"flexCheckDefault"},J={key:0},K={key:1},Q={class:"row mt-5"},X=e("h3",null,"會員資訊",-1),Y={class:"mb-3 col-md-2"},Z=e("label",{for:"name",class:"form-label"},"名稱",-1),ee={class:"mb-3 col-md-2"},te=e("label",{for:"phone",class:"form-label"},"電話",-1),de={class:"mb-3 col-md-3"},se=e("label",{for:"email",class:"form-label"},"電子信箱",-1),oe={class:"mb-3 col-md-8"},le=e("label",{for:"address",class:"form-label"},"寄送地址",-1),re={class:"row mt-5"},ne=e("h3",null,"訂購商品",-1),ae={class:"px-3"},ie={class:"table align-middle table-sm",style:{width:"800px"}},ce=e("thead",{class:"table-light"},[e("tr",null,[e("td",null,"商品編號"),e("td",null,"商品名稱"),e("td",{class:"text-end"},"商品數量"),e("td",{class:"text-end"},"小計")])],-1),_e={class:"text-end"},me={class:"text-end"},ue=e("td",{colspan:"3",class:"text-end"},"總計",-1),pe={class:"text-end"},he={class:"modal-footer"},be=e("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 關閉 ",-1);function fe(o,t,n,m,d,u){return l(),r("div",U,[e("div",D,[e("div",I,[A,e("div",E,[e("div",L,[e("div",null,[T,e("div",R,[e("div",B,[N,a(e("input",{id:"orderId","onUpdate:modelValue":t[0]||(t[0]=s=>d.editOrder.id=s),type:"text",class:"form-control",readonly:""},null,512),[[_,d.editOrder.id]])]),e("div",S,[H,a(e("input",{id:"create_at","onUpdate:modelValue":t[1]||(t[1]=s=>d.editOrder.create_at=s),type:"text",class:"form-control",readonly:""},null,512),[[_,d.editOrder.create_at]])]),e("div",q,[z,a(e("input",{id:"num","onUpdate:modelValue":t[2]||(t[2]=s=>d.editOrder.num=s),type:"text",class:"form-control",readonly:""},null,512),[[_,d.editOrder.num]])]),e("div",F,[j,e("div",W,[a(e("input",{class:"form-check-input",type:"checkbox",id:"flexCheckDefault","onUpdate:modelValue":t[3]||(t[3]=s=>d.editOrder.is_paid=s)},null,512),[[V,d.editOrder.is_paid]]),e("label",G,[d.editOrder.is_paid?(l(),r("span",J,"已付款")):(l(),r("span",K,"未付款"))])])])]),e("div",Q,[X,e("div",Y,[Z,a(e("input",{id:"name","onUpdate:modelValue":t[4]||(t[4]=s=>d.editOrder.user.name=s),type:"text",class:"form-control",readonly:""},null,512),[[_,d.editOrder.user.name]])]),e("div",ee,[te,a(e("input",{id:"phone","onUpdate:modelValue":t[5]||(t[5]=s=>d.editOrder.user.tel=s),type:"text",class:"form-control",readonly:""},null,512),[[_,d.editOrder.user.tel]])]),e("div",de,[se,a(e("input",{id:"email","onUpdate:modelValue":t[6]||(t[6]=s=>d.editOrder.user.email=s),type:"text",class:"form-control",readonly:""},null,512),[[_,d.editOrder.user.email]])])]),e("div",oe,[le,a(e("input",{id:"address","onUpdate:modelValue":t[7]||(t[7]=s=>d.editOrder.user.address=s),type:"text",class:"form-control",readonly:""},null,512),[[_,d.editOrder.user.address]])]),e("div",re,[ne,e("div",ae,[e("table",ie,[ce,e("tbody",null,[(l(!0),r(p,null,M(d.editOrder.products,s=>(l(),r("tr",{key:s.id},[e("td",null,i(s.id),1),e("td",null,i(s.product.title),1),e("td",_e,i(s.qty),1),e("td",me,i(s.total),1)]))),128))]),e("tfoot",null,[e("tr",null,[ue,e("td",pe,i(d.editOrder.total),1)])])])])])])])]),e("div",he,[be,e("button",{type:"button",class:"btn btn-secondary",onClick:t[8]||(t[8]=s=>o.$emit("update-paid",d.editOrder))}," 修改付款狀態 ")])])])],512)}const Oe=O(P,[["render",fe]]),ye={props:["tempOrder","delOrder"],data(){return{modalOrderDel:null}},mixins:[g],methods:{},mounted(){}},ve={id:"delOrderModal",ref:"modal",class:"modal fade",tabindex:"-1","aria-labelledby":"delOrderModalLabel","aria-hidden":"true"},xe={class:"modal-dialog"},Me={class:"modal-content border-0"},ge=e("div",{class:"modal-header bg-danger text-white"},[e("h5",{id:"delOrderModalLabel",class:"modal-title"},[e("span",null,"刪除訂單")]),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),ke={class:"modal-body"},Ce={class:"text-danger"},Ve={class:"modal-footer"},$e=e("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function we(o,t,n,m,d,u){return l(),r("div",ve,[e("div",xe,[e("div",Me,[ge,e("div",ke,[y(" 是否刪除訂單編號 "),e("strong",Ce,i(n.tempOrder.id),1),y(" 訂單(刪除後將無法恢復)。 ")]),e("div",Ve,[$e,e("button",{type:"button",class:"btn btn-danger",onClick:t[0]||(t[0]=(...s)=>n.delOrder&&n.delOrder(...s))},"確認刪除")])])])],512)}const Pe=O(ye,[["render",we]]);var Ue={VITE_API_URL:"https://ec-course-api.hexschool.io/v2",VITE_API_PATH:"js23",BASE_URL:"/HW-Vue-week6/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_API_URL:b,VITE_API_PATH:f}=Ue,De={components:{OrderModal:Oe,DelOrderModal:Pe},data(){return{orders:[],currentPage:1,tempOrder:{user:{}}}},mounted(){this.getOrders()},methods:{getOrders(){const o=`${b}/api/${f}/admin/orders`;h.get(o).then(t=>{this.orders=t.data.orders}).catch(()=>{alert("取得訂單資訊失敗")})},openModal(o,t){o==="edit"?(this.tempOrder={...t},console.log(this.tempOrder),this.$refs.orderModal.openModal()):o==="delete"&&(this.tempOrder={...t},this.$refs.delOrderModal.openModal())},updatePaid(o){const t=`${b}/api/${f}/admin/order/${o.id}`,n={is_paid:o.is_paid};h.put(t,{data:n}).then(m=>{console.log(m.data),alert("新增/修改成功"),this.$refs.orderModal.hideModal(),this.getOrders(this.currentPage)}).catch(m=>{alert(m.response.data.message)})},delOrder(){const o=`${b}/api/${f}/admin/order/${this.tempOrder.id}`;h.delete(o).then(t=>{console.log(t.data),alert("刪除成功"),this.$refs.delOrderModal.hideModal(),this.getOrders(this.currentPage)}).catch(()=>{alert("刪除失敗")})}}},Ie=e("h2",{class:"mt-2"},"訂單管理",-1),Ae={class:"container"},Ee={class:"row"},Le={class:"table mt-4"},Te=e("thead",null,[e("tr",null,[e("th",{width:"120"},"訂單編號"),e("th",{width:"120"},"會員名稱"),e("th",{width:"120"},"帳款狀態"),e("th",{width:"120"},"編輯訂單"),e("th",{width:"120"},"刪除訂單")])],-1),Re={key:0,class:"text-success"},Be={key:1},Ne=["onClick"],Se=["onClick"];function He(o,t,n,m,d,u){const s=v("Order-Modal"),k=v("Del-Order-Modal");return l(),r(p,null,[Ie,e("div",Ae,[e("div",Ee,[e("table",Le,[Te,e("tbody",null,[(l(!0),r(p,null,M(d.orders,c=>(l(),r(p,{key:c.id},[d.orders.length?(l(),r("tr",{key:0,class:$({"text-secondary":!c.is_paid})},[e("td",null,i(c.id),1),e("td",null,i(c.user.name),1),e("td",null,[c.is_paid?(l(),r("span",Re,"已付款")):(l(),r("span",Be,"未付款"))]),e("td",null,[e("button",{type:"button",class:"btn btn-outline-secondary btn-sm",onClick:C=>u.openModal("edit",c)}," 編輯 ",8,Ne)]),e("td",null,[e("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:C=>u.openModal("delete",c)}," 刪除 ",8,Se)])],2)):w("",!0)],64))),128))])])]),x(s,{ref:"orderModal","temp-order":d.tempOrder,onUpdatePaid:u.updatePaid},null,8,["temp-order","onUpdatePaid"]),x(k,{ref:"delOrderModal","temp-order":d.tempOrder,"del-order":u.delOrder},null,8,["temp-order","del-order"])])],64)}const Fe=O(De,[["render",He]]);export{Fe as default};
