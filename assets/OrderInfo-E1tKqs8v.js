import{_ as A,m as S,a as j,r as _,o as i,c as d,b as e,h as a,i as b,F as y,f as x,t as c,d as n,e as N,w,l as P,G as p,g as $,v as E}from"./index-HDW0_ElR.js";import{c as k}from"./cartStore-uLKU_geR.js";import{A as h}from"./swal-Vw0mg_-T.js";import"./sweetalert2.all-RiftlNpZ.js";var U={VITE_API_URL:"https://ec-course-api.hexschool.io/v2",VITE_API_PATH:"js23",VITE_MAP_KEY:"AIzaSyBLmNf-TuB_bpae0roR3SSEJy40ssJR5eI",BASE_URL:"/HW-Vue-week6/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_API_URL:V,VITE_API_PATH:C}=U,R={data(){return{user:{name:"",email:"",tel:"",address:""},message:"",coupon:"",orderId:""}},mounted(){this.getCart()},computed:{...S(k,["carts","order_total","deliveryFee","final_total"])},methods:{...j(k,["getCart","removeCartsAll","delCartItem","changeCartQty","alertDelAll"]),getCoupon(){this.coupon="vegan032024",this.getCart()},addCoupon(){const t={code:this.coupon};this.$http.post(`${V}/api/${C}/coupon`,{data:t}).then(s=>{h.toastTop(s.data.message,"success"),this.getCart()}).catch(s=>{h.toastTop(s.response.data.message,"error")})},isPhone(t){return/^(09)[0-9]{8}$/.test(t)?!0:"需為正確的手機號碼格式"},toProducts(){this.$router.push("/products")},createOrder(){if(this.carts.length){const t={user:this.user,message:this.message};this.$http.post(`${V}/api/${C}/order`,{data:t}).then(s=>{h.toastTop(s.data.message,"success"),this.getCart(),this.$refs.form.resetForm(),this.orderId=s.data.orderId,this.$router.push(`/checkout/${this.orderId}`)}).catch(s=>{h.toastTop(s.response.data.message,"error")})}else h.toastTop("目前購物車中無任何餐點，無法送出訂單","error")}}},D={class:"container"},F={class:"my-3"},L={class:"breadcrumb"},q={class:"breadcrumb-item"},B={class:"breadcrumb-item"},O=e("li",{class:"breadcrumb-item"},"填寫訂單資訊",-1),z={class:"my-4"},M={key:0},H=P('<div class="row justify-content-center mb-4 mb-lg-10"><div class="col-3 border-bottom border-5 border-primary"><div class="d-flex flex-column align-items-center"><div class="rounded-circle bg-primary text-white d-flex align-items-center justify-content-center mb-1" style="width:20px;height:20px;"> 1 </div><p class="text-primary mb-2 fw-bold">填寫資料</p></div></div><div class="col-3 border-bottom border-5 border-gray"><div class="d-flex flex-column align-items-center"><div class="rounded-circle bg-gray-3 text-light d-flex align-items-center justify-content-center mb-1" style="width:20px;height:20px;"> 2 </div><p class="text-gray-3 mb-2 fw-bold">確認付款</p></div></div><div class="col-3 border-bottom border-5 border-gray"><div class="d-flex flex-column align-items-center"><div class="rounded-circle bg-gray-3 text-light d-flex align-items-center justify-content-center mb-1" style="width:20px;height:20px;"> 3 </div><p class="text-gray-3 mb-2 fw-bold">完成訂購</p></div></div></div>',1),J={class:"row justify-content-center"},Q={class:"col-lg-5 mb-5 mb-lg-0"},G={class:"d-flex justify-content-between align-items-center"},K=e("p",{class:"d-flex align-items-center text-dark mb-6"},[e("span",{class:"material-icons fs-6 me-2"}," arrow_back_ios "),n("繼續購物 ")],-1),W={class:"table align-middle"},Y=e("tr",{class:"border-bottom"},null,-1),X={class:"d-flex align-items-center justify-content-between gap-5 py-4 px-0"},Z={class:"d-flex align-items-center"},ee=["onClick"],se=e("i",{class:"bi bi-x-square fs-5 text-gray-600"},null,-1),te=[se],oe=["src"],le={class:"d-flex align-items-center justify-content-between w-75"},ae={class:"mb-1"},ne={class:"mb-1"},re={style:{width:"80px"}},ie=["onUpdate:modelValue","onChange","disabled"],de=["value"],ce={class:"mb-0 text-end"},me={class:"d-flex align-items center gap-1 mb-2"},ue=e("i",{class:"bi bi-tags-fill fs-5"},null,-1),_e=e("label",{class:"form-label"},[n("結帳輸入 "),e("span",{class:"text-primary fw-bold fs-6"},"vegan032024"),n(" 即享有9折本月優惠")],-1),be={class:"input-group input-group-sm mb-3"},pe=["value"],he={class:"d-flex justify-content-between"},fe=e("p",{class:"fs-6 mb-2"},"小計",-1),ge={class:"fs-6 mb-2 fw-bold"},ve={class:"d-flex justify-content-between"},ye={class:"fs-6 mb-2"},xe={key:0,class:"text-danger"},we={key:1,class:"text-primary"},ke={class:"fs-6 mb-2 fw-bold"},Ve={class:"d-flex justify-content-between"},Ce=e("p",{class:"fs-6 mb-2"},"總計",-1),Te={class:"fs-6 mb-2 fw-bold"},Ie={key:0,class:"d-flex justify-content-between mb-2"},Ae=e("p",{class:"fs-6 mb-2 text-danger"},"折扣價",-1),Se={class:"fs-6 mb-2 fw-bold text-danger"},je={class:"col-lg-5 mb-3 mb-lg-0"},Ne={class:"card border-0 bg-light-green py-4 p-lg-2 ms-lg-4"},Pe={class:"card-body"},$e=e("h2",{class:"h5 text-center mb-4"},"訂單連絡資訊",-1),Ee={class:"mb-4"},Ue=e("label",{for:"name",class:"form-label"},[n("姓名"),e("span",{class:"text-danger"},"*")],-1),Re={class:"mb-4"},De=e("label",{for:"phone",class:"form-label"},[n("手機"),e("span",{class:"text-danger"},"*")],-1),Fe={class:"mb-3"},Le=e("label",{for:"email",class:"form-label"},[n("信箱"),e("span",{class:"text-danger"},"*")],-1),qe={class:"mb-4"},Be=e("label",{for:"address",class:"form-label"},[n("外送地址"),e("span",{class:"text-danger"},"*")],-1),Oe={class:"mb-4"},ze=e("label",{for:"message",class:"form-label"},"訂單備註",-1),Me=e("div",{class:"mb-4"},[e("p",null,[n("註："),e("span",{class:"text-danger"},"*"),n("為必填欄位")])],-1),He=e("button",{type:"submit",class:"btn btn-secondary w-100"},"送出訂單",-1),Je={key:1,class:"text-center"},Qe=e("i",{class:"bi bi-cart4 fs-1 text-primary"},null,-1),Ge=e("h3",{class:"fs-5 mb-6 mt-3"},"目前購物車是空的喔! 再去選購吧~",-1);function Ke(t,s,We,Ye,r,m){var v;const g=_("RouterLink"),u=_("v-field"),f=_("error-message"),T=_("v-form"),I=_("router-link");return i(),d("div",D,[e("nav",F,[e("ol",L,[e("li",q,[a(g,{to:"/",class:"text-primary"},{default:b(()=>[n("首頁")]),_:1})]),e("li",B,[a(g,{to:"/products",class:"text-primary"},{default:b(()=>[n("線上訂餐")]),_:1})]),O])]),e("main",z,[(v=t.carts)!=null&&v.length?(i(),d("div",M,[H,e("div",J,[e("section",Q,[e("div",G,[a(g,{to:"/products"},{default:b(()=>[K]),_:1}),e("button",{type:"button",class:"btn btn-sm btn-outline-danger fs-7",onClick:s[0]||(s[0]=(...o)=>t.alertDelAll&&t.alertDelAll(...o))}," 清空購物車 ")]),e("table",W,[e("tbody",null,[Y,(i(!0),d(y,null,x(t.carts,o=>(i(),d("tr",{key:o.id},[e("td",X,[e("div",Z,[e("a",{role:"button",class:p(["btn p-0 me-3",{disabled:t.loadingStatus===o.id}]),onClick:w(l=>t.delCartItem(o.id),["prevent"]),style:{"border-color":"transparent"}},te,10,ee),e("img",{src:o.product.imageUrl,class:"object-fit-cover flex-shrink-0",width:"80",height:"80",alt:"cart.product.title"},null,8,oe)]),e("div",le,[e("div",null,[e("p",ae,c(o.product.title),1),e("p",ne," NT$"+c(t.$filters.currency(o.product.price))+" / "+c(o.product.unit),1),e("div",re,[$(e("select",{"onUpdate:modelValue":l=>o.qty=l,class:"form-select form-select-sm",onChange:l=>t.changeCartQty(o),disabled:t.loadingStatus===o.id},[(i(),d(y,null,x(20,l=>e("option",{key:l+1234,value:l},c(l),9,de)),64))],40,ie),[[E,o.qty]])])]),e("p",ce,"NT$"+c(t.$filters.currency(o.total)),1)])])]))),128))])]),e("div",me,[ue,_e,e("button",{type:"button",class:"btn btn-outline-dark btn-sm py-0 mb-2 ms-1 flex-shrink-0",style:{"font-size":"12px"},onClick:s[1]||(s[1]=(...o)=>m.getCoupon&&m.getCoupon(...o))}," 取得優惠 ")]),e("div",be,[e("input",{type:"text",class:"form-control",placeholder:"請輸入優惠碼","aria-label":"請輸入優惠碼",value:r.coupon,"aria-describedby":"button-addon2"},null,8,pe),e("button",{class:"btn btn-outline-primary",type:"button",id:"button-addon2",onClick:s[2]||(s[2]=(...o)=>m.addCoupon&&m.addCoupon(...o))}," 套用 ")]),e("div",he,[fe,e("p",ge,"NT$"+c(t.$filters.currency(this.order_total)),1)]),e("div",ve,[e("p",ye,[n(" 運費 "),t.order_total<300?(i(),d("small",xe,"(消費滿 $300 可享免運優惠)")):(i(),d("small",we,"(已達免運門檻！)"))]),e("p",ke,"NT$"+c(t.deliveryFee),1)]),e("div",Ve,[Ce,e("p",Te,"NT$"+c(t.$filters.currency(t.order_total+t.deliveryFee)),1)]),t.order_total!==t.final_total?(i(),d("div",Ie,[Ae,e("p",Se," NT$"+c(t.$filters.currency(t.final_total+t.deliveryFee)),1)])):N("",!0)]),e("section",je,[e("div",Ne,[e("div",Pe,[a(T,{onSubmit:m.createOrder,ref:"form"},{default:b(({errors:o})=>[$e,e("div",Ee,[Ue,a(u,{id:"name",name:"姓名",type:"text",class:p(["form-control",{"is-invalid":o.姓名}]),placeholder:"請填寫真實姓名",rules:"required",modelValue:r.user.name,"onUpdate:modelValue":s[3]||(s[3]=l=>r.user.name=l)},null,8,["class","modelValue"]),a(f,{name:"姓名",class:"invalid-feedback"})]),e("div",Re,[De,a(u,{id:"phone",name:"手機",type:"tel",class:p(["form-control",{"is-invalid":o.手機}]),placeholder:"0912345678",rules:m.isPhone,modelValue:r.user.tel,"onUpdate:modelValue":s[4]||(s[4]=l=>r.user.tel=l)},null,8,["class","rules","modelValue"]),a(f,{name:"手機",class:"invalid-feedback"})]),e("div",Fe,[Le,a(u,{id:"email",name:"信箱",type:"email",class:p(["form-control",{"is-invalid":o.信箱}]),placeholder:"example@email.com",rules:"email|required",modelValue:r.user.email,"onUpdate:modelValue":s[5]||(s[5]=l=>r.user.email=l)},null,8,["class","modelValue"]),a(f,{name:"信箱",class:"invalid-feedback"})]),e("div",qe,[Be,a(u,{id:"address",name:"外送地址",type:"text",class:p(["form-control",{"is-invalid":o.外送地址}]),placeholder:"請填寫地址",rules:"required",modelValue:r.user.address,"onUpdate:modelValue":s[6]||(s[6]=l=>r.user.address=l)},null,8,["class","modelValue"]),a(f,{name:"外送地址",class:"invalid-feedback"})]),e("div",Oe,[ze,a(u,{as:"textarea",id:"message",name:"訂單備註",class:"form-control",rows:"3",modelValue:r.message,"onUpdate:modelValue":s[7]||(s[7]=l=>r.message=l),style:{resize:"none"}},null,8,["modelValue"])]),Me,He]),_:1},8,["onSubmit"])])])])])])):(i(),d("div",Je,[Qe,Ge,a(I,{to:"",onClick:s[8]||(s[8]=w(o=>m.toProducts(),["prevent"])),class:"btn btn-secondary fs-lg-5 px-3 py-2 px-lg-6"},{default:b(()=>[n("前往訂餐")]),_:1})]))])])}const ts=A(R,[["render",Ke]]);export{ts as default};
